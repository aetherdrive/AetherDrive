<!DOCTYPE html>
<html lang="no">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AetherDrive V3 Dashboard</title>
<style>
  body { font-family: Arial; padding: 2rem; background: #f0f2f5; color: #333; }
  h1 { color: #0077cc; }
  .card { background: #fff; padding: 1rem 2rem; margin: 1rem 0; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
</style>
</head>
<body>
<h1>AetherDrive V3 Dashboard</h1>

<div class="card"><strong>Status:</strong> <span id="status">Laster...</span></div>
<div class="card"><strong>Antall brukere:</strong> <span id="users">0</span></div>
<div class="card"><strong>Månedlig inntekt:</strong> <span id="revenue">0 NOK</span></div>
<div class="card">
  <strong>Ansatte og lønn:</strong>
  <ul id="employee-salaries"></ul>
</div>

<script>
async function fetchMetrics() {
  try {
    const res = await fetch('/api/metrics');
    if (!res.ok) {
      throw new Error(`Ugyldig svar: ${res.status}`);
    }
    const data = await res.json();
    document.getElementById('status').textContent = data.status || 'Live';
    document.getElementById('users').textContent = data.users || 0;
    const currency = data.currency || 'NOK';
    document.getElementById('revenue').textContent = Number.isFinite(data.revenue)
      ? data.revenue.toLocaleString() + ` ${currency}`
      : `0 ${currency}`;
    const ul = document.getElementById('employee-salaries');
    ul.innerHTML = "";
    if (data.employees) {
      data.employees.forEach(emp => {
        const li = document.createElement('li');
        li.textContent = `${emp.name}: ${emp.currentSalary.toLocaleString()} NOK`;
        ul.appendChild(li);
      });
    }
  } catch (err) {
    document.getElementById('status').textContent = 'Feil ved henting';
    console.error(err);
  }
}

fetchMetrics();
setInterval(fetchMetrics, 10000);
</script>
</body>
</html>
